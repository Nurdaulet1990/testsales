<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>课程页面</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .no-share-notice {
      background-color: #ffeeee;
      border: 1px solid #ffcccc;
      color: #cc0000;
      padding: 10px;
      margin: 10px 0;
      font-weight: bold;
      text-align: center;
      border-radius: 5px;
    }
    #videoContainer {
      position: relative;
    }
    .video-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      z-index: 10;
    }
  </style>
</head>
<body oncontextmenu="return false">
  <div class="course-container">
    <h2>欢迎回来！</h2>
    <div class="no-share-notice">⚠️ 根据平台规定，禁止分享或传播视频链接。视频仅限于本页面观看。</div>
    <div id="videoContainer"></div>
    <p id="privateVideoNote" style="color: #666; font-style: italic;">注意：这是一个私人视频，您需要授权才能查看。</p>
    <button onclick="logout()">退出登录</button>
  </div>
  <script>
    // Disable right-click
    document.addEventListener('contextmenu', event => event.preventDefault());
    
    // Disable keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // Disable Ctrl+S, Ctrl+U, F12
      if (
        (e.ctrlKey && (e.keyCode === 83 || e.keyCode === 85)) || 
        e.keyCode === 123
      ) {
        e.preventDefault();
        return false;
      }
    });

    if (!localStorage.getItem("loggedInToday")) {
      window.location.href = "index.html";
    } else {
      // Create the iframe with the video
      const iframe = document.createElement("iframe");
      iframe.width = "560";
      iframe.height = "315";
      
      // Generate a unique session token to help prevent direct access
      const sessionToken = Math.random().toString(36).substring(2, 15);
      localStorage.setItem("videoSessionToken", sessionToken);
      
      // Append a random query parameter to make it harder to copy the link
      iframe.src = "https://www.youtube.com/embed/LBNQlV3yk3w?rel=0&modestbranding=1&session=" + sessionToken;
      iframe.frameBorder = "0";
      iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
      iframe.allowFullscreen = true;
      iframe.onload = function() {
        console.log("Video loaded");
      };
      iframe.onerror = function() {
        document.getElementById("privateVideoNote").innerHTML += " <strong>无法加载视频。请确保您有权限观看此私人视频。</strong>";
      };
      document.getElementById("videoContainer").appendChild(iframe);
      
      // Add a transparent overlay to make it harder to right-click on the video
      const overlay = document.createElement("div");
      overlay.className = "video-overlay";
      overlay.addEventListener("contextmenu", e => e.preventDefault());
      document.getElementById("videoContainer").appendChild(overlay);
      
      // Check if this is a valid session
      setInterval(function() {
        if (localStorage.getItem("videoSessionToken") !== sessionToken) {
          window.location.href = "index.html";
        }
      }, 5000);
    }

    function logout() {
      localStorage.removeItem("loggedInToday");
      localStorage.removeItem("videoSessionToken");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
