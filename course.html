<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>课程页面</title>
  <link rel="stylesheet" href="style.css">
  <style>
    #videoContainer {
      position: relative;
      /* Removed pointer-events: none to allow video interaction */
    }
    .copyright-overlay {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background-color: rgba(0,0,0,0.7);
      color: white;
      padding: 5px 8px;
      border-radius: 3px;
      font-size: 12px;
      pointer-events: none;
      z-index: 999;
    }
    .no-sharing-warning {
      color: #e74c3c;
      font-weight: bold;
      margin: 10px 0;
      padding: 5px;
      border: 1px solid #e74c3c;
      background-color: #fadbd8;
      border-radius: 4px;
    }
    .error-message {
      color: red;
      font-weight: bold;
      margin-top: 10px;
      display: none;
    }
    .direct-link {
      margin-top: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="course-container">
    <h2>欢迎回来！</h2>
    <div id="videoContainer">
      <!-- Copyright overlay will be added here -->
    </div>
    <p id="errorMessage" class="error-message">无法加载视频，请点击下方链接直接在YouTube上观看：</p>
    <a id="directLink" class="direct-link" href="https://www.youtube.com/watch?v=LBNQlV3yk3w" target="_blank">在YouTube上观看视频</a>
    <p class="no-sharing-warning">严禁分享：本视频内容受版权保护，严禁分享链接或录制视频内容。违者将承担法律责任。</p>
    <p id="privateVideoNote" style="color: #666; font-style: italic;">注意：这是一个私人视频，您需要授权才能查看。</p>
    <button onclick="logout()">退出登录</button>
  </div>
  <script>
    // Allow basic keyboard functionality but still prevent copying 
    document.addEventListener('keydown', function(e) {
      if ((e.ctrlKey || e.metaKey) && 
          (e.key === 'c' || e.key === 's')) {
        e.preventDefault();
        return false;
      }
    });
    
    if (!localStorage.getItem("loggedInToday")) {
      window.location.href = "index.html";
    } else {
      const videoContainer = document.getElementById("videoContainer");
      const errorMessage = document.getElementById("errorMessage");
      const directLink = document.getElementById("directLink");
      
      // Create overlay with copyright notice
      const overlay = document.createElement("div");
      overlay.className = "copyright-overlay";
      overlay.textContent = "© 版权所有 - 禁止分享";
      
      // Create and add iframe with YouTube video
      const iframe = document.createElement("iframe");
      iframe.width = "560";
      iframe.height = "315";
      // Using standard YouTube embed with controls enabled
      iframe.src = "https://www.youtube.com/embed/LBNQlV3yk3w";
      iframe.frameBorder = "0";
      iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
      iframe.allowFullscreen = true;
      
      iframe.onload = function() {
        console.log("Video loaded");
        videoContainer.appendChild(overlay);
      };
      
      iframe.onerror = function() {
        console.error("Error loading video");
        errorMessage.style.display = "block";
        directLink.style.display = "block";
      };
      
      // Add error handling in case iframe fails to load
      setTimeout(function() {
        if (!iframe.contentWindow || !iframe.contentWindow.document) {
          errorMessage.style.display = "block";
          directLink.style.display = "block";
        }
      }, 3000);
      
      videoContainer.appendChild(iframe);
      
      // Add unique user identifier watermark
      const userWatermark = document.createElement("div");
      userWatermark.className = "copyright-overlay";
      userWatermark.style.bottom = "40px";
      userWatermark.textContent = "授权用户ID: " + Math.random().toString(36).substr(2, 9);
      videoContainer.appendChild(userWatermark);
    }

    function logout() {
      localStorage.removeItem("loggedInToday");
      window.location.href = "index.html";
    }
    
    // Provide a fallback for video display issues
    window.addEventListener('error', function(e) {
      console.error('Error event:', e.message);
      document.getElementById("errorMessage").style.display = "block";
      document.getElementById("directLink").style.display = "block";
    }, true);
  </script>
</body>
</html>
